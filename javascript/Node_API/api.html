<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <header class="p-3 text-bg-dark">
  <div class="container">
    <div
      class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start"
    >
      <a
        href="/"
        class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none"
      >
        <svg
          class="bi me-2"
          width="40"
          height="32"
          role="img"
          aria-label="Bootstrap"
        >
          <use xlink:href="#bootstrap"></use>
        </svg>
      </a>

      <ul
        class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0"
      >
        <li><a href="#" class="nav-link px-2 text-secondary">Home</a></li>
        <li><a href="#" class="nav-link px-2 text-white">Features</a></li>
        <li><a href="#" class="nav-link px-2 text-white">Pricing</a></li>
        <li><a href="#" class="nav-link px-2 text-white">FAQs</a></li>
        <li><a href="#" class="nav-link px-2 text-white">About</a></li>
      </ul>

      <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3" role="search">
        <input
          type="search"
          class="form-control form-control-dark text-bg-dark"
          placeholder="Search..."
          aria-label="Search"
        />
      </form>

      <div class="text-end">
        <button type="button" class="btn btn-outline-light me-2">Login</button>
        <button type="button" class="btn btn-warning">Sign-up</button>
      </div>
    </div>
  </div>
</header>

    <main>
    	<div class="container">
  <div class="row mt-4 mb-4">
    <div class="col-md-12">
      <h1 class="border-bottom">Users List</h1>
    </div>
  </div>
  <div class="row">
  		<div class="col">
  			<input type="text" class="form-control" name="id" id="id" placeholder="ID" aria-label="First name">
  		</div>
  		<div class="col">
  			<input type="text" class="form-control" name="name" id="full_name" placeholder="First name" aria-label="First name">
  		</div>
  		<div class="col">
  			<input type="email" class="form-control" name="email" id="email" placeholder="Email" aria-label="Last name">
  		</div>
  		<div class="col">
  			<input type="text" class="form-control" name="gender" id="gender" placeholder="Gender" aria-label="Last name">
  		</div>
  		<div class="col">
  			<input type="text" class="form-control" name="phone" id="phone" placeholder="Phone" aria-label="Last name">
  		</div>
  		<div class="col">
  			<input type="button" onclick="postData()" class="btn btn-primary" id="formdata" value="Add Data">
  		</div>
  </div>
  <div class="row">
    <table class="table">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Name</th>
          <th scope="col">Email</th>
          <th scope="col">Phone</th>
          <th scope="col">Gender</th>
          <th scope="col">Action</th>
        </tr>
      </thead>
      <tbody id="table_data">
      </tbody>
    </table>
    <div class="links">
    	<nav aria-label="...">
  <ul class="pagination" id="pagination">
    
  </ul>
</nav>
    </div>
  </div>
</div>

    </main>
    <div class="container">
  <footer class="py-3 my-4">
    <ul class="nav justify-content-center border-bottom pb-3 mb-3">
      <li class="nav-item">
        <a href="#" class="nav-link px-2 text-body-secondary">Home</a>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link px-2 text-body-secondary">Features</a>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link px-2 text-body-secondary">Pricing</a>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link px-2 text-body-secondary">FAQs</a>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link px-2 text-body-secondary">About</a>
      </li>
    </ul>
    <p class="text-center text-body-secondary">Â© 2024 Company, Inc</p>
  </footer>
</div>

  </body>

  <script type="text/javascript">
  	// iffe
  	function postData() {

  		let data = {
  			id: id.value,
  			name: full_name.value,
  			email: email.value,
  			phone: phone.value,
  			gender: gender.value
  		}

		// POST request using fetch() 
		fetch("http://localhost:4000/add", { 
		      
		    // Adding method type 
		    method: "POST", 
		      
		    // Adding body or contents to send 
		    body: JSON.stringify(data), 
		      
		    // Adding headers to the request 
		    headers: { 
		        "Content-type": "application/json; charset=UTF-8"
		    } 
		}) 
		  
		// Converting to JSON 
		.then(response => response.json()) 
		  
		// Displaying results to console 
		.then(json => userData() ); 
  	}
  	userData();
  	function userData(limit = 10, skip = 0) {
  		let mytable = document.getElementById("data");
  		fetch(`http://localhost:4000/${limit}/${skip}`)
		.then(res => res.json())
		.then(json => {
			console.log(json.totalCount);
			let html = "";
			json.userData.map( elem => {
				html += `<tr>
		          <th scope="row">${elem.id}</th>
		          <th scope="row">${elem.name}</th>
		          <th scope="row">${elem.email}</th>
		          <th scope="row">${elem.phone}</th>
		          <th scope="row">${elem.gender}</th>
		          <th>
		            <a href="javascript:;" onclick="findData('${elem._id}')" class="btn btn-primary"><i class="bi bi-pencil"></i></a>
		            <a
		              onclick="deleteRec('${elem._id}')"
		              class="btn btn-danger"
		              href="javascript:;"
		              ><i class="bi bi-trash"></i
		            ></a>
		          </th>
		        </tr>`;
			} );
			table_data.innerHTML = html;

			let pages = Math.ceil(json.totalCount / 10);
			let htmlp = "";
			for (let p = 0; p < pages; p++) {
				htmlp += `<li class="page-item"><a onclick='userData(10, ${p})' class="page-link" href="javascript:;">${p + 1}</a></li>`;
			}
			pagination.innerHTML = htmlp;
		});
  	}

  	function deleteRec(id) {
  		if(!confirm('are you sure')) return false;

  		let data = {};
		// POST request using fetch() 
		fetch(`http://localhost:4000/user/${id}`, { 
		      
		    // Adding method type 
		    method: "DELETE", 
		      
		    // Adding body or contents to send 
		    body: JSON.stringify(data), 
		      
		    // Adding headers to the request 
		    headers: { 
		        "Content-type": "application/json; charset=UTF-8"
		    } 
		}) 
		  
		// Converting to JSON 
		.then(response => response.json()) 
		  
		// Displaying results to console 
		.then(json => userData() ); 
  	}

  	function findData(id) {
  		
  		let data = {};
		// POST request using fetch() 
		fetch(`http://localhost:4000/find/${id}`) 
		  
		// Converting to JSON 
		.then(response => response.json()) 
		  
		// Displaying results to console 
		.then(json => console.log(json) ); 
  	}
  	
  </script>
</html>
